import{r as m,c as s,j as e,F as I,M as K,d as B,I as W,p as R,q as F,B as Q,t as X,E as Z,f as C,u as J,v as D,w as x,x as S,y as ee,z as te,A as se,a as ae,H as ne,P as ue,_ as ie}from"./vendor.6b141815.js";import{u as y,U as ce,r as le,c as k,E as g,I as N,d as re,e as oe,f as de,L as me,R as G,B as U}from"./index.84b58e98.js";const he=t=>{const{items:c}=t,[a,l]=m.exports.useState(c[0].key),u=i=>{l(i)};return s("div",{className:"tabs",children:[e("div",{className:"tab-nav-list",children:c.map(({title:i,key:o})=>e("div",{className:`tabs-tab ${o===a?"tabs-tab-active":""}`,onClick:()=>u(o),children:i},o))}),e("div",{className:"tabs-content-list",children:c.map(({key:i,content:o})=>e("div",{className:`tabs-content-item ${i===a?"":"tabs-content-item-hidden"}`,children:o},i))})]})},pe=["\u5927\u4E00","\u5927\u4E8C","\u5927\u4E09","\u5927\u56DB","\u7855\u58EB\u7814\u7A76\u751F","\u535A\u58EB\u7814\u7A76\u751F","\u5927\u5B66\u8001\u5E08","\u516C\u53F8\u6280\u672F\u5DE5\u7A0B\u5E08","\u5176\u4ED6"],P=[{value:"\u672A\u8BA2\u9605\u901A\u77E5",label:"\u4E0D\u8BA2\u9605\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5",label:"\u8BA2\u9605\u77ED\u4FE1\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u7535\u8BDD\u901A\u77E5",label:"\u8BA2\u9605\u7535\u8BDD\u901A\u77E5"},{value:"\u5DF2\u8BA2\u9605\u5168\u90E8\u901A\u77E5",label:"\u8BA2\u9605\u5168\u90E8\u901A\u77E5"}],Ee=t=>{const[c]=B.useForm();return s(B,{form:c,className:"normal-form",onFinish:async l=>{let u={...l};u.status==2&&!u.name.endsWith("\u8001\u5E08")&&(u.name=u.name+"\u8001\u5E08"),u.status=u.status||1,u.phone=localStorage.getItem(ce),u.clientId=t.courseInfo.clientId,u.courseId=t.courseInfo.courseId,u.uniCourseId=t.courseInfo.id,u.course=t.courseInfo.title,u.verify="1",u.classId=1;const i=await le(u);t.onSubmit(i)},autoComplete:"off",size:"large",labelCol:{span:4},wrapperCol:{span:20},initialValues:{gender:"\u7537",tag:P[1].value},children:[e("h3",{children:"\u62A5\u540D"}),e(B.Item,{label:"\u59D3\u540D",name:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u59D3\u540D"}],children:e(W,{placeholder:"\u8BF7\u8F93\u5165\u59D3\u540D"})}),e(B.Item,{label:"\u6027\u522B",name:"gender",children:s(R.Group,{children:[e(R,{value:"\u7537",children:"\u7537"}),e(R,{value:"\u5973",children:"\u5973"})]})}),e(B.Item,{label:"\u5E74\u7EA7",name:"age",children:e(F,{children:pe.map(l=>e(F.Option,{value:l,children:l},l))})}),e(B.Item,{label:"\u5907\u6CE8",name:"tag",children:e(F,{children:P.map(({label:l,value:u})=>e(F.Option,{value:u,children:l},u))})}),e(B.Item,{wrapperCol:{span:24},children:e(Q,{style:{width:"100%"},type:"primary",htmlType:"submit",children:"\u786E\u8BA4"})})]})},ge=t=>{const[c,a]=m.exports.useState(t.defaultVisible),{state:{myRegisters:l},dispatch:u}=y();return s(I,{children:[e("button",{className:"btn",onClick:()=>a(!0),children:"\u7ACB\u5373\u62A5\u540D"}),e(K,{width:350,open:c,footer:null,onCancel:()=>a(!1),maskClosable:!1,children:e(Ee,{onSubmit:o=>{var d;u({type:"UPDATE_MY_COURSES",payload:(l||[]).concat(o)}),(d=t.onRegisterCourse)==null||d.call(t,o),a(!1)},courseInfo:t.courseInfo})})]})};const q={2:"status-teacher.png",4:"status-ta.png",5:"status-admin.png"},fe=t=>{const c=k();return X(t.data)?e("div",{className:"studentlist-wrap",children:e(Z,{})}):c!=null&&c.mobile()?e("div",{className:"list-mobile",children:C(t.data,(a,l)=>s("div",{className:"list-item",children:[e("div",{className:"list-item-index",children:l+1}),s("div",{className:"list-item-main-info",children:[s("div",{className:"info-name",children:[a.name,a.status!==g.STUDENT&&e("img",{height:"14",src:`img/${q[a.status]}`,alt:"student-status-png"})]}),e("div",{className:"info-other",children:s("span",{className:"current-bg",children:[e("span",{className:"list-item-label",children:"\u804C\u4E1A:"})," ",a.age]})})]}),e("div",{className:`list-item-gender ${a.gender==="\u5973"?"woman":"man"}`,children:a.gender==="\u5973"?e(N,{symbol:"icon-nv"}):e(N,{symbol:"icon-xingbienan"})}),e("div",{className:"list-item-tag",children:a.tag})]},a.id))}):e("div",{className:"list-wrap",children:s("table",{cellSpacing:"0",cellPadding:"0",children:[e("thead",{children:s("tr",{children:[e("th",{children:e("span",{children:"\u6635\u79F0"})}),e("th",{children:e("span",{children:"\u5E74\u7EA7"})}),e("th",{children:e("span",{children:"\u6027\u522B"})}),e("th",{children:e("span",{children:"\u5907\u6CE8"})})]})}),e("tbody",{children:C(t.data,(a,l)=>s("tr",{children:[s("td",{className:"lalign",children:[e("span",{className:"index",children:l+1}),s("span",{className:"student-name",children:[a.name,a.status!==g.STUDENT&&e("img",{height:"14",src:`img/${q[a.status]}`,alt:"student-status-png"})]})]}),e("td",{children:a.age}),e("td",{children:a.gender}),e("td",{children:a.tag})]},a.id))})]})})},be=["\u6559\u5BA4\u53F7","\u8BFE\u7A0B\u540D\u79F0","\u5F00\u59CB\u65F6\u95F4","\u4E0A\u8BFE\u5730\u70B9","\u5907\u6CE8","\u8BFE\u5802\u56DE\u653E"],Be=t=>{const c=k(),a=J(),{state:{currentUser:l,myRegisters:u},dispatch:i}=y(),{id:o}=D(),d=async n=>a(`replay/${n.id}`),r=n=>{if(l!=null&&l.phone){const h=x(u,p=>p.courseId===o);if(h){let{verify:p}=h;p==="1"?d(n):S.alert({content:"\u8BF7\u8D2D\u4E70\u540E\u89C2\u770B",closeOnMaskClick:!0})}else S.alert({content:"\u8BF7\u62A5\u540D\u8BFE\u7A0B\u540E\u89C2\u770B",closeOnMaskClick:!0})}else i({type:"UPDATE_LOGIN_DIALOG_VISIBLE",payload:!0})};return c!=null&&c.mobile()?e("div",{className:"list-mobile",children:C(t.data,n=>s("div",{className:"list-item",onClick:()=>r(n),children:[s("div",{className:"list-item-main-info",children:[s("div",{className:"info-name",children:[n.className,e("span",{className:"location-tag",children:n.location})]}),s("div",{children:[e("span",{className:"list-item-label",children:"\u6559\u5BA4\u53F7:"})," ",n.roomId]}),s("div",{children:[e("span",{className:"list-item-label",children:"\u5F00\u59CB\u65F6\u95F4:"})," ",n.startAt]}),s("div",{children:[e("span",{className:"list-item-label",children:"\u5907\u6CE8:"})," ",n.remark]})]}),e("div",{className:"list-item-actions",children:e(N,{symbol:"icon-bofang"})})]},n.id))}):e("div",{className:"list-wrap",children:s("table",{cellSpacing:"0",cellPadding:"0",children:[e("thead",{children:e("tr",{children:be.map(n=>e("th",{children:e("span",{children:n})},n))})}),e("tbody",{children:C(t.data,(n,h)=>s("tr",{children:[s("td",{className:"lalign",children:[e("span",{className:"index",children:h+1}),n.roomId]}),e("td",{children:n.className}),e("td",{children:n.startAt}),e("td",{children:n.location}),e("td",{children:n.remark}),e("td",{children:e("span",{className:"player-btn",onClick:()=>r(n),children:e(N,{symbol:"icon-bofang"})})})]},n.id))})]})})};const z=t=>{const{state:{currentUser:c,myRegisters:a},dispatch:l}=y(),{id:u}=D(),i=m.exports.useRef(null),o=m.exports.useRef(null);let d="";if(c!=null&&c.phone){const r=x(a,n=>n.courseId===u);if(r){const n=encodeURIComponent(`pages/room/room?userId=${r.phone}-m&roomId=${t.courseInfo.roomId}&role=${G[r.status]||"student"}&username=${r.name}-m`);d=`${U}/seller/api/room/path.jpg?path=${n}`}else{const n=encodeURIComponent(`pages/index/index?roomId=${t.courseInfo.roomId}`);d=`${U}/seller/api/room/path.jpg?path=${n}`}}return m.exports.useEffect(()=>{if(o.current){const r=o.current,n=new XMLSerializer().serializeToString(r);i.current.src=`data:image/svg+xml;base64,${btoa(n)}`}},[o.current]),s(I,{children:[e(ie,{ref:o,style:{display:"none",height:"auto",maxWidth:"100%",width:"100%"},value:window.location.href,fgColor:"#3db477",viewBox:"0 0 256 256"}),s("div",{className:"share-box",children:[s("span",{children:[e(N,{symbol:"icon-share"}),"\u5206\u4EAB\u4E8C\u7EF4\u7801"]}),e("span",{style:{marginBottom:10},children:"\u9080\u8BF7\u597D\u53CB\u52A0\u5165\u8BFE\u5802"}),s("div",{className:`share-imgs ${t.isMobile?"share-imgs-mobile":""}`,children:[e("img",{ref:i,alt:"share-course",className:"qr-code"}),d&&e("img",{src:d,alt:"mini"})]})]})]})},j=t=>{const{state:{currentUser:c,myRegisters:a},dispatch:l}=y(),{id:u}=D(),i=()=>{l({type:"UPDATE_LOGIN_DIALOG_VISIBLE",payload:!0})},o=d=>{const{name:r,phone:n,status:h}=d,p=`https://room.rustedu.com?username=${r}&userId=${n}&role=${G[h]||"student"}&roomId=${t.courseInfo.roomId}&video=${t.courseInfo.ishd||"480"}p&title=${t.courseInfo.title}`;window.open(p)};if(c!=null&&c.phone){const d=x(a,r=>r.courseId===u);return d?e("button",{className:"btn",onClick:()=>{let{verify:r}=d;r==="1"?o(d):S.alert({content:"\u65E0\u6CD5\u8FDB\u5165\u6559\u5BA4",closeOnMaskClick:!0})},children:"\u5DF2\u62A5\u540D\uFF0C\u8FDB\u5165\u6559\u5BA4"}):e(ge,{...t})}return e("button",{className:"btn",onClick:i,children:"\u767B\u5F55"})},ve=()=>{var $,w,T,_,L;const[t,c]=m.exports.useState({}),[a,l]=m.exports.useState([]),u=k(),i=m.exports.useRef({}),[o,d]=m.exports.useState(!0),{id:r}=D(),n=m.exports.useCallback(async()=>{if(r){const f=await re(r),A=await oe(r),E=ee(A,"status"),M=E[g.TEACHER]||[],H=E[g.TUTOR]||[],V=E[g.ADMIN]||[];let v=[];te(E).filter(b=>![g.TEACHER,g.TUTOR,g.ADMIN].includes(b)).forEach(b=>{v=v.concat(E[b])}),i.current.applyStudents=v,i.current.teacher=se(M);const Y=M.concat(H,V,v);l(Y),i.current.if_teacher=!i.current.teacher;const O=await de(r);i.current.replayList=O,i.current.validReplayList=ae(O.filter(({status:b})=>b==1)||[],b=>b.startAt),c(f),d(!1)}},[r]);if(m.exports.useEffect(()=>{n()},[n]),m.exports.useEffect(()=>{var f,A;if(t.title){let E="Rust\u57F9\u8BAD - "+(t.title||"")+" - \u963F\u56FE\u6559\u80B2";document.title=E,(f=document.querySelector('meta[name="description"]'))==null||f.setAttribute("content",t.summary),(A=document.querySelector('meta[name="keywords"]'))==null||A.setAttribute("content",E)}},[t]),o)return e(me,{});const h=[{key:"intro",title:"\u8BFE\u7A0B\u4ECB\u7ECD",content:e("div",{className:"ql-snow ql-editor",dangerouslySetInnerHTML:{__html:t.introduction}})},{key:"student",title:`\u62A5\u540D\u6210\u5458(${(a==null?void 0:a.length)||0})`,content:e(fe,{data:a})},{key:"replay",title:`\u8BFE\u5802\u56DE\u653E(${($=i.current.validReplayList)==null?void 0:$.length})`,content:e(Be,{data:i.current.validReplayList})}],p=f=>{l((a||[]).concat(f)),i.current.applyStudents=(i.current.applyStudents||[]).concat(f)};return s("div",{className:"course-detail-wrapper",children:[s(ne,{children:[e("title",{children:"Rust\u57F9\u8BAD - "+t.title+" - \u963F\u56FE\u6559\u80B2"}),e("meta",{"data-n-head":"ssr",name:"description",content:t.summary}),e("meta",{"data-n-head":"ssr",name:"keywords",content:t.title+"\u6BDB\u8C46\u8BFE\u5802,\u5728\u7EBF\u6559\u80B2,\u4E92\u52A8\u6559\u5BA4,\u7F51\u6821\u7CFB\u7EDF,\u5728\u7EBF\u76F4\u64AD\u6559\u5BA4,\u4E92\u52A8\u6559\u5B66\u5E73\u53F0"})]}),s("section",{className:"main-content",children:[e("img",{src:t.coverUrl,alt:"coverUrl",className:"course-cover"}),e("div",{className:"course-main-info",children:u!=null&&u.mobile()?s(I,{children:[e("div",{className:"course-title",children:t.title}),s("div",{className:"course-info",children:[s("div",{className:"course-info-item",children:[e("span",{className:"course-info-item-label",children:"\u4EFB\u8BFE\u6559\u5E08: "}),(w=i.current.teacher)==null?void 0:w.name]}),s("div",{className:"course-info-item",children:[e("span",{className:"course-info-item-label",children:"\u5B66\u751F\u4EBA\u6570: "}),(T=i.current.applyStudents)==null?void 0:T.length," \u4EBA"]}),s("span",{className:"course-actions",children:[e("span",{className:"course-price",children:"\xA5"+t.price}),e(ue,{placement:"leftTop",content:e(z,{courseInfo:t,isMobile:!0}),trigger:"click",children:e("span",{className:"share-icon",children:e(N,{symbol:"icon-share"})})})]})]}),e(j,{courseInfo:t,onRegisterCourse:p})]}):s(I,{children:[e("div",{className:"course-title",children:t.title}),s("div",{className:"course-info",children:[s("div",{className:"course-info-item",children:[e("span",{className:"course-info-item-label",children:"\u4EFB\u8BFE\u6559\u5E08: "}),(_=i.current.teacher)==null?void 0:_.name]}),s("div",{className:"course-info-item",children:[e("span",{className:"course-info-item-label",children:"\u5B66\u751F\u4EBA\u6570: "}),(L=i.current.applyStudents)==null?void 0:L.length," \u4EBA"]})]}),s("div",{className:"course-actions",children:[s("div",{className:"course-price",children:[" ","\xA5"+t.price]}),e(j,{courseInfo:t,onRegisterCourse:p})]}),e("div",{className:"share-area",children:e(z,{courseInfo:t})})]})})]}),e("section",{className:"course-intro",children:e(he,{items:h})})]})};export{ve as default};
